c      
c     SUBROUTINE residual
c      
      subroutine residual(funcs,j)
        include 'common_geo.inc'
        include 'common.inc'
        dimension funcs(ncomp)
        call switches(j)
          funcs(1) = sp(1,j)-spold(1,j)
          funcs(2) = -kfeo2*sp(11,j)*sp(2,j)/4+2*kdi*sw19*sp(27,j)-kmnox
     +*sp(10,j)*sp(2,j)/2+(-1+por(j))/por(j)*nu/(inita+sp(32,j))*sp(1,j)
     +*sw11*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-(0.1D
     +1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3)-sw05*(0.1D
     +1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-(0.1D1-sw02)*sp(
     +2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3))*(sw06+(0.1D1-sw06)*s
     +p(4,j)/kmmno2)-sw07*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.
     +1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmn
     +o3)-sw05*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-(0
     +.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3))*(sw06+
     +(0.1D1-sw06)*sp(4,j)/kmmno2))*(sw08+(0.1D1-sw08)*sp(5,j)/kmfeoh3)-
     +sw09*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-(0.1D1
     +-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3)-sw05*(0.1D1
     +-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-(0.1D1-sw02)*sp(2
     +,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3))*(sw06+(0.1D1-sw06)*sp
     +(4,j)/kmmno2)-sw07*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1
     +D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno
     +3)-sw05*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-(0.
     +1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3))*(sw06+(
     +0.1D1-sw06)*sp(4,j)/kmmno2))*(sw08+(0.1D1-sw08)*sp(5,j)/kmfeoh3))*
     +(sw10+(0.1D1-sw10)*sp(6,j)/kmso4))+(-1+por(j))/por(j)*nu/(inita+sp
     +(32,j))*sp(1,j)*sw09*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0
     +.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/km
     +no3)-sw05*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-(
     +0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3))*(sw06
     ++(0.1D1-sw06)*sp(4,j)/kmmno2)-sw07*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j
     +)/kmo2-sw03*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw
     +04)*sp(3,j)/kmno3)-sw05*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03
     +*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)
     +/kmno3))*(sw06+(0.1D1-sw06)*sp(4,j)/kmmno2))*(sw08+(0.1D1-sw08)*sp
     +(5,j)/kmfeoh3))*(sw10+(0.1D1-sw10)*sp(6,j)/kmso4)-(836875.D0/58668
     +.D0*sp(38,j)-5655.D0/4889.D0*sp(40,j)-249925.D0/58668.D0*sp(46,j)+
     +0.4435535D7/704016.D0*sp(50,j)+340405.D0/19556.D0*sp(42,j)+351715.
     +D0/29334.D0*sp(43,j)+385645.D0/58668.D0*sp(44,j)+5655.D0/4889.D0*s
     +p(45,j)-7329.D0/1378.D0*sp(16,j)-88759.D0/8268.D0*sp(17,j)-65.D0/1
     +2.D0*sp(18,j)+65.D0/12.D0*sp(20,j)+65.D0/6.D0*sp(11,j)+53.D0/6.D0*
     +sp(12,j)+41.D0/12.D0*sp(13,j)-15725.D0/8268.D0*sp(14,j)+811.D0/826
     +8.D0*sp(15,j)+53.D0/6.D0*sp(27,j)+502775.D0/29334.D0*sp(22,j)-1572
     +5.D0/8268.D0*sp(7,j)+569.D0/156.D0*sp(8,j)+65.D0/6.D0*sp(10,j)+sp(
     +2,j)-809.D0/156.D0*sp(3,j)-86293733.D0/0.13474084D8*(-1+por(j))/po
     +r(j)*sp(21,j)-569.D0/156.D0*(-1+por(j))/por(j)*sp(23,j)-53.D0/6.D0
     +*(-1+por(j))/por(j)*sp(25,j)-811.D0/8268.D0*(-1+por(j))/por(j)*sp(
     +26,j)-53.D0/3.D0*(-1+por(j))/por(j)*sp(28,j)-65.D0/6.D0*(-1+por(j)
     +)/por(j)*sp(29,j)-811.D0/8268.D0*(-1+por(j))/por(j)*sp(31,j)-86293
     +733.D0/0.13474084D8*(-1+por(j))/por(j)*sp(36,j)-86293733.D0/0.1347
     +4084D8*(-1+por(j))/por(j)*sp(37,j)+0.1741519D7/0.156448D7*(-1+por(
     +j))/por(j)*sp(39,j)+5655.D0/4889.D0*(-1+por(j))/por(j)*sp(41,j)+18
     +096.D0/24445.D0*(-1+por(j))/por(j)*sp(47,j)-1254435.D0/39112.D0*(-
     +1+por(j))/por(j)*sp(48,j))/delt+(-15725.D0/8268.D0*spold(7,j)+569.
     +D0/156.D0*spold(8,j)+65.D0/6.D0*spold(10,j)+spold(2,j)-809.D0/156.
     +D0*spold(3,j)+836875.D0/58668.D0*spold(38,j)-5655.D0/4889.D0*spold
     +(40,j)-249925.D0/58668.D0*spold(46,j)+0.4435535D7/704016.D0*spold(
     +50,j)+340405.D0/19556.D0*spold(42,j)+351715.D0/29334.D0*spold(43,j
     +)+385645.D0/58668.D0*spold(44,j)+5655.D0/4889.D0*spold(45,j)-7329.
     +D0/1378.D0*spold(16,j)-88759.D0/8268.D0*spold(17,j)-65.D0/12.D0*sp
     +old(18,j)+65.D0/12.D0*spold(20,j)+65.D0/6.D0*spold(11,j)+53.D0/6.D
     +0*spold(12,j)+41.D0/12.D0*spold(13,j)-15725.D0/8268.D0*spold(14,j)
     ++811.D0/8268.D0*spold(15,j)+53.D0/6.D0*spold(27,j)+502775.D0/29334
     +.D0*spold(22,j)-86293733.D0/0.13474084D8*(-1+por(j))/por(j)*spold(
     +21,j)-569.D0/156.D0*(-1+por(j))/por(j)*spold(23,j)-53.D0/6.D0*(-1+
     +por(j))/por(j)*spold(25,j)-811.D0/8268.D0*(-1+por(j))/por(j)*spold
     +(26,j)-53.D0/3.D0*(-1+por(j))/por(j)*spold(28,j)-65.D0/6.D0*(-1+po
     +r(j))/por(j)*spold(29,j)-811.D0/8268.D0*(-1+por(j))/por(j)*spold(3
     +1,j)-86293733.D0/0.13474084D8*(-1+por(j))/por(j)*spold(36,j)-86293
     +733.D0/0.13474084D8*(-1+por(j))/por(j)*spold(37,j)+0.1741519D7/0.1
     +56448D7*(-1+por(j))/por(j)*spold(39,j)+5655.D0/4889.D0*(-1+por(j))
     +/por(j)*spold(41,j)+18096.D0/24445.D0*(-1+por(j))/por(j)*spold(47,
     +j)-1254435.D0/39112.D0*(-1+por(j))/por(j)*spold(48,j))/delt
          funcs(3) = 46.D0/53.D0*(-1+por(j))/por(j)*nu/(inita+sp(32,j))*
     +sp(1,j)*sw03*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-s
     +w04)*sp(3,j)/kmno3)-(23.D0/26.D0*sp(3,j)-69.D0/689.D0*sp(7,j)+23.D
     +0/26.D0*sp(8,j)-69.D0/689.D0*sp(14,j)-69.D0/689.D0*sp(15,j)-69.D0/
     +689.D0*sp(16,j)-69.D0/689.D0*sp(17,j)+69.D0/689.D0*(-1+por(j))/por
     +(j)*sp(21,j)-23.D0/26.D0*(-1+por(j))/por(j)*sp(23,j)+69.D0/689.D0*
     +(-1+por(j))/por(j)*sp(26,j)+69.D0/689.D0*(-1+por(j))/por(j)*sp(31,
     +j)+69.D0/689.D0*(-1+por(j))/por(j)*sp(36,j)+69.D0/689.D0*(-1+por(j
     +))/por(j)*sp(37,j))/delt+(23.D0/26.D0*spold(3,j)-69.D0/689.D0*spol
     +d(7,j)+23.D0/26.D0*spold(8,j)-69.D0/689.D0*spold(17,j)-69.D0/689.D
     +0*spold(14,j)-69.D0/689.D0*spold(15,j)-69.D0/689.D0*spold(16,j)+69
     +.D0/689.D0*(-1+por(j))/por(j)*spold(21,j)-23.D0/26.D0*(-1+por(j))/
     +por(j)*spold(23,j)+69.D0/689.D0*(-1+por(j))/por(j)*spold(26,j)+69.
     +D0/689.D0*(-1+por(j))/por(j)*spold(31,j)+69.D0/689.D0*(-1+por(j))/
     +por(j)*spold(36,j)+69.D0/689.D0*(-1+por(j))/por(j)*spold(37,j))/de
     +lt
          funcs(4) = kh2sfeoh3*sp(5,j)*(sp(12,j)+sp(13,j))+2*nu/(inita+s
     +p(32,j))*sp(1,j)*sw11*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(
     +0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/k
     +mno3)-sw05*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-
     +(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3))*(sw0
     +6+(0.1D1-sw06)*sp(4,j)/kmmno2)-sw07*(0.1D1-sw02-(0.1D1-sw02)*sp(2,
     +j)/kmo2-sw03*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-s
     +w04)*sp(3,j)/kmno3)-sw05*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw0
     +3*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j
     +)/kmno3))*(sw06+(0.1D1-sw06)*sp(4,j)/kmmno2))*(sw08+(0.1D1-sw08)*s
     +p(5,j)/kmfeoh3)-sw09*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0
     +.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/km
     +no3)-sw05*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-(
     +0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3))*(sw06
     ++(0.1D1-sw06)*sp(4,j)/kmmno2)-sw07*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j
     +)/kmo2-sw03*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw
     +04)*sp(3,j)/kmno3)-sw05*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03
     +*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)
     +/kmno3))*(sw06+(0.1D1-sw06)*sp(4,j)/kmmno2))*(sw08+(0.1D1-sw08)*sp
     +(5,j)/kmfeoh3))*(sw10+(0.1D1-sw10)*sp(6,j)/kmso4))+2*nu/(inita+sp(
     +32,j))*sp(1,j)*sw09*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.
     +1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmn
     +o3)-sw05*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-(0
     +.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3))*(sw06+
     +(0.1D1-sw06)*sp(4,j)/kmmno2)-sw07*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)
     +/kmo2-sw03*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw0
     +4)*sp(3,j)/kmno3)-sw05*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*
     +(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/
     +kmno3))*(sw06+(0.1D1-sw06)*sp(4,j)/kmmno2))*(sw08+(0.1D1-sw08)*sp(
     +5,j)/kmfeoh3))*(sw10+(0.1D1-sw10)*sp(6,j)/kmso4)+2*nu/(inita+sp(32
     +,j))*sp(1,j)*sw07*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D
     +1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3
     +)-sw05*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-(0.1
     +D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3))*(sw06+(0
     +.1D1-sw06)*sp(4,j)/kmmno2))*(sw08+(0.1D1-sw08)*sp(5,j)/kmfeoh3)-kf
     +emno2*sp(11,j)*sp(4,j)+kh2smno2pr*sp(33,j)*(sp(12,j)+sp(13,j))-kmn
     +age*sp(4,j)+kfeage*sp(5,j)/2+4*por(j)/(-1+por(j))*kdi*sw19*sp(27,j
     +)-por(j)/(-1+por(j))*kmnox*sp(10,j)*sp(2,j)-(-86293733.D0/0.673704
     +2D7*sp(36,j)-86293733.D0/0.6737042D7*sp(37,j)+0.1741519D7/782240.D
     +0*sp(39,j)+3323.D0/4134.D0*sp(31,j)+36192.D0/24445.D0*sp(47,j)-125
     +4435.D0/19556.D0*sp(48,j)+11310.D0/4889.D0*sp(41,j)-811.D0/4134.D0
     +*sp(26,j)-106.D0/3.D0*sp(28,j)-65.D0/3.D0*sp(29,j)-86293733.D0/0.6
     +737042D7*sp(21,j)-569.D0/78.D0*sp(23,j)-53.D0/3.D0*sp(25,j)+sp(4,j
     +)-sp(5,j)/2+2*por(j)/(-1+por(j))*sp(2,j)-809.D0/78.D0*por(j)/(-1+p
     +or(j))*sp(3,j)-15725.D0/4134.D0*por(j)/(-1+por(j))*sp(7,j)+569.D0/
     +78.D0*por(j)/(-1+por(j))*sp(8,j)+62.D0/3.D0*por(j)/(-1+por(j))*sp(
     +10,j)+65.D0/3.D0*por(j)/(-1+por(j))*sp(11,j)+53.D0/3.D0*por(j)/(-1
     ++por(j))*sp(12,j)+41.D0/6.D0*por(j)/(-1+por(j))*sp(13,j)-15725.D0/
     +4134.D0*por(j)/(-1+por(j))*sp(14,j)+811.D0/4134.D0*por(j)/(-1+por(
     +j))*sp(15,j)-7329.D0/689.D0*por(j)/(-1+por(j))*sp(16,j)-88759.D0/4
     +134.D0*por(j)/(-1+por(j))*sp(17,j)-65.D0/6.D0*por(j)/(-1+por(j))*s
     +p(18,j)+65.D0/6.D0*por(j)/(-1+por(j))*sp(20,j)+502775.D0/14667.D0*
     +por(j)/(-1+por(j))*sp(22,j)+53.D0/3.D0*por(j)/(-1+por(j))*sp(27,j)
     ++836875.D0/29334.D0*por(j)/(-1+por(j))*sp(38,j)-11310.D0/4889.D0*p
     +or(j)/(-1+por(j))*sp(40,j)+340405.D0/9778.D0*por(j)/(-1+por(j))*sp
     +(42,j)+351715.D0/14667.D0*por(j)/(-1+por(j))*sp(43,j)+385645.D0/29
     +334.D0*por(j)/(-1+por(j))*sp(44,j)+11310.D0/4889.D0*por(j)/(-1+por
     +(j))*sp(45,j)-249925.D0/29334.D0*por(j)/(-1+por(j))*sp(46,j)+0.443
     +5535D7/352008.D0*por(j)/(-1+por(j))*sp(50,j))/delt+(spold(4,j)-spo
     +ld(5,j)/2-86293733.D0/0.6737042D7*spold(36,j)-86293733.D0/0.673704
     +2D7*spold(37,j)+0.1741519D7/782240.D0*spold(39,j)+3323.D0/4134.D0*
     +spold(31,j)+36192.D0/24445.D0*spold(47,j)-1254435.D0/19556.D0*spol
     +d(48,j)+11310.D0/4889.D0*spold(41,j)-811.D0/4134.D0*spold(26,j)-10
     +6.D0/3.D0*spold(28,j)-65.D0/3.D0*spold(29,j)-86293733.D0/0.6737042
     +D7*spold(21,j)-569.D0/78.D0*spold(23,j)-53.D0/3.D0*spold(25,j)-887
     +59.D0/4134.D0*por(j)/(-1+por(j))*spold(17,j)-65.D0/6.D0*por(j)/(-1
     ++por(j))*spold(18,j)+65.D0/6.D0*por(j)/(-1+por(j))*spold(20,j)+502
     +775.D0/14667.D0*por(j)/(-1+por(j))*spold(22,j)+53.D0/3.D0*por(j)/(
     +-1+por(j))*spold(27,j)+836875.D0/29334.D0*por(j)/(-1+por(j))*spold
     +(38,j)-11310.D0/4889.D0*por(j)/(-1+por(j))*spold(40,j)+340405.D0/9
     +778.D0*por(j)/(-1+por(j))*spold(42,j)+351715.D0/14667.D0*por(j)/(-
     +1+por(j))*spold(43,j)+385645.D0/29334.D0*por(j)/(-1+por(j))*spold(
     +44,j)+11310.D0/4889.D0*por(j)/(-1+por(j))*spold(45,j)-249925.D0/29
     +334.D0*por(j)/(-1+por(j))*spold(46,j)+0.4435535D7/352008.D0*por(j)
     +/(-1+por(j))*spold(50,j)+2*por(j)/(-1+por(j))*spold(2,j)-809.D0/78
     +.D0*por(j)/(-1+por(j))*spold(3,j)-15725.D0/4134.D0*por(j)/(-1+por(
     +j))*spold(7,j)+569.D0/78.D0*por(j)/(-1+por(j))*spold(8,j)+62.D0/3.
     +D0*por(j)/(-1+por(j))*spold(10,j)+65.D0/3.D0*por(j)/(-1+por(j))*sp
     +old(11,j)+53.D0/3.D0*por(j)/(-1+por(j))*spold(12,j)+41.D0/6.D0*por
     +(j)/(-1+por(j))*spold(13,j)-15725.D0/4134.D0*por(j)/(-1+por(j))*sp
     +old(14,j)+811.D0/4134.D0*por(j)/(-1+por(j))*spold(15,j)-7329.D0/68
     +9.D0*por(j)/(-1+por(j))*spold(16,j))/delt
          funcs(5) = 8*por(j)/(-1+por(j))*kh2so2*(sp(12,j)+sp(13,j))*sp(
     +2,j)+16*por(j)/(-1+por(j))*kdi*sw19*sp(27,j)-(16*sp(25,j)+32*sp(28
     +,j)-16*por(j)/(-1+por(j))*sp(12,j)-16*por(j)/(-1+por(j))*sp(13,j)-
     +16*por(j)/(-1+por(j))*sp(27,j)-16*por(j)/(-1+por(j))*sp(6,j))/delt
     ++(16*spold(25,j)+32*spold(28,j)-16*por(j)/(-1+por(j))*spold(27,j)-
     +16*por(j)/(-1+por(j))*spold(6,j)-16*por(j)/(-1+por(j))*spold(12,j)
     +-16*por(j)/(-1+por(j))*spold(13,j))/delt
          funcs(6) = (-1+por(j))/por(j)*kh2smno2pr*sp(33,j)*(sp(12,j)+sp
     +(13,j))/8+(-1+por(j))/por(j)*kh2sfeoh3*sp(5,j)*(sp(12,j)+sp(13,j))
     +/8+(-1+por(j))/por(j)*kh2smno2*sp(4,j)*(sp(12,j)+sp(13,j))/8+kdi*s
     +w19*sp(27,j)/2+(-1+por(j))/por(j)*kfeage*sp(5,j)/16-(12875.D0/1955
     +6.D0*sp(38,j)-261.D0/4889.D0*sp(40,j)-3845.D0/19556.D0*sp(46,j)+68
     +239.D0/234672.D0*sp(50,j)+15711.D0/19556.D0*sp(42,j)+5411.D0/9778.
     +D0*sp(43,j)+5933.D0/19556.D0*sp(44,j)+261.D0/4889.D0*sp(45,j)+7.D0
     +/424.D0*sp(16,j)-99.D0/424.D0*sp(17,j)-sp(18,j)/4+sp(20,j)/4+sp(11
     +,j)/2-sp(13,j)/4-99.D0/424.D0*sp(14,j)+113.D0/424.D0*sp(15,j)+7735
     +.D0/9778.D0*sp(22,j)-99.D0/424.D0*sp(7,j)+sp(8,j)/16+3.D0/8.D0*sp(
     +10,j)+sp(2,j)/4+sp(3,j)/16-1155809.D0/0.2072936D7*(-1+por(j))/por(
     +j)*sp(21,j)-(-1+por(j))/por(j)*sp(23,j)/16-113.D0/424.D0*(-1+por(j
     +))/por(j)*sp(26,j)-(-1+por(j))/por(j)*sp(29,j)/2-15.D0/106.D0*(-1+
     +por(j))/por(j)*sp(31,j)-1155809.D0/0.2072936D7*(-1+por(j))/por(j)*
     +sp(36,j)-1155809.D0/0.2072936D7*(-1+por(j))/por(j)*sp(37,j)+401889
     +.D0/0.78224D7*(-1+por(j))/por(j)*sp(39,j)+261.D0/4889.D0*(-1+por(j
     +))/por(j)*sp(41,j)+4176.D0/122225.D0*(-1+por(j))/por(j)*sp(47,j)-5
     +7897.D0/39112.D0*(-1+por(j))/por(j)*sp(48,j)-(-1+por(j))/por(j)*sp
     +(5,j)/16)/delt+(-99.D0/424.D0*spold(7,j)+spold(8,j)/16+3.D0/8.D0*s
     +pold(10,j)+spold(2,j)/4+spold(3,j)/16+12875.D0/19556.D0*spold(38,j
     +)-261.D0/4889.D0*spold(40,j)-3845.D0/19556.D0*spold(46,j)+68239.D0
     +/234672.D0*spold(50,j)+15711.D0/19556.D0*spold(42,j)+5411.D0/9778.
     +D0*spold(43,j)+5933.D0/19556.D0*spold(44,j)+261.D0/4889.D0*spold(4
     +5,j)+7.D0/424.D0*spold(16,j)-99.D0/424.D0*spold(17,j)-spold(18,j)/
     +4+spold(20,j)/4+spold(11,j)/2-spold(13,j)/4-99.D0/424.D0*spold(14,
     +j)+113.D0/424.D0*spold(15,j)+7735.D0/9778.D0*spold(22,j)-1155809.D
     +0/0.2072936D7*(-1+por(j))/por(j)*spold(21,j)-(-1+por(j))/por(j)*sp
     +old(23,j)/16-113.D0/424.D0*(-1+por(j))/por(j)*spold(26,j)-(-1+por(
     +j))/por(j)*spold(29,j)/2-15.D0/106.D0*(-1+por(j))/por(j)*spold(31,
     +j)-1155809.D0/0.2072936D7*(-1+por(j))/por(j)*spold(36,j)-1155809.D
     +0/0.2072936D7*(-1+por(j))/por(j)*spold(37,j)+401889.D0/0.78224D7*(
     +-1+por(j))/por(j)*spold(39,j)+261.D0/4889.D0*(-1+por(j))/por(j)*sp
     +old(41,j)+4176.D0/122225.D0*(-1+por(j))/por(j)*spold(47,j)-57897.D
     +0/39112.D0*(-1+por(j))/por(j)*spold(48,j)-(-1+por(j))/por(j)*spold
     +(5,j)/16)/delt
          funcs(7) = -kdi*sw19*sp(27,j)+kfesprecip*sw13*(sp(11,j)*sp(13,
     +j)/sp(20,j)/KsFeS-0.1D1)-kaom*sp(7,j)*sp(6,j)+(-1+por(j))/por(j)*k
     +fesdiss*(0.1D1-sw13)*sp(25,j)*(0.1D1-sp(11,j)*sp(13,j)/sp(20,j)/Ks
     +FeS)+(-1+por(j))/por(j)*nu/(inita+sp(32,j))*sp(1,j)*sw09*(0.1D1-sw
     +02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)
     +/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3)-sw05*(0.1D1-sw02-(0.1D1-s
     +w02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw0
     +4+(0.1D1-sw04)*sp(3,j)/kmno3))*(sw06+(0.1D1-sw06)*sp(4,j)/kmmno2)-
     +sw07*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-(0.1D1
     +-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3)-sw05*(0.1D1
     +-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-(0.1D1-sw02)*sp(2
     +,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3))*(sw06+(0.1D1-sw06)*sp
     +(4,j)/kmmno2))*(sw08+(0.1D1-sw08)*sp(5,j)/kmfeoh3))*(sw10+(0.1D1-s
     +w10)*sp(6,j)/kmso4)/2-(2*sp(6,j)+sp(12,j)+sp(13,j)+sp(27,j)-2*(-1+
     +por(j))/por(j)*sp(25,j)-3*(-1+por(j))/por(j)*sp(28,j))/delt+(2*spo
     +ld(6,j)+spold(12,j)+spold(13,j)+spold(27,j)-2*(-1+por(j))/por(j)*s
     +pold(25,j)-3*(-1+por(j))/por(j)*spold(28,j))/delt
          funcs(8) = ksnh4*sp(8,j)*por(j)-sp(23,j)*(1.D0-por(j))
          funcs(9) = kspo4*sp(9,j)*por(j)-sp(24,j)*(1.D0-por(j))
          funcs(10) = -kmnco3precip*sw12*(sp(10,j)*sp(17,j)/KsMnCO3-0.1D
     +1)-(-1+por(j))/por(j)*sp(31,j)/delt+(-1+por(j))/por(j)*spold(31,j)
     +/delt
          funcs(11) = ksfe*sp(11,j)*por(j)-sp(29,j)*(1.D0-por(j))
          funcs(12) = sp(20,j)*sp(13,j)-keq3*sp(12,j)
          funcs(13) = 3*kdi*sw19*sp(27,j)-3*kfesprecip*sw13*(sp(11,j)*sp
     +(13,j)/sp(20,j)/KsFeS-0.1D1)-3*kaomo2*sp(7,j)*sp(2,j)-3*(-1+por(j)
     +)/por(j)*kfesdiss*(0.1D1-sw13)*sp(25,j)*(0.1D1-sp(11,j)*sp(13,j)/s
     +p(20,j)/KsFeS)-3.D0/2.D0*(-1+por(j))/por(j)*nu/(inita+sp(32,j))*sp
     +(1,j)*sw11*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-
     +(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3)-sw05*
     +(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-(0.1D1-sw02
     +)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3))*(sw06+(0.1D1-sw
     +06)*sp(4,j)/kmmno2)-sw07*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw0
     +3*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j
     +)/kmno3)-sw05*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw
     +02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3))*(
     +sw06+(0.1D1-sw06)*sp(4,j)/kmmno2))*(sw08+(0.1D1-sw08)*sp(5,j)/kmfe
     +oh3)-sw09*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-(
     +0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3)-sw05*(
     +0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-(0.1D1-sw02)
     +*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3))*(sw06+(0.1D1-sw0
     +6)*sp(4,j)/kmmno2)-sw07*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03
     +*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)
     +/kmno3)-sw05*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw0
     +2-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3))*(s
     +w06+(0.1D1-sw06)*sp(4,j)/kmmno2))*(sw08+(0.1D1-sw08)*sp(5,j)/kmfeo
     +h3))*(sw10+(0.1D1-sw10)*sp(6,j)/kmso4))-3.D0/2.D0*(-1+por(j))/por(
     +j)*nu/(inita+sp(32,j))*sp(1,j)*sw09*(0.1D1-sw02-(0.1D1-sw02)*sp(2,
     +j)/kmo2-sw03*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-s
     +w04)*sp(3,j)/kmno3)-sw05*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw0
     +3*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j
     +)/kmno3))*(sw06+(0.1D1-sw06)*sp(4,j)/kmmno2)-sw07*(0.1D1-sw02-(0.1
     +D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*
     +(sw04+(0.1D1-sw04)*sp(3,j)/kmno3)-sw05*(0.1D1-sw02-(0.1D1-sw02)*sp
     +(2,j)/kmo2-sw03*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D
     +1-sw04)*sp(3,j)/kmno3))*(sw06+(0.1D1-sw06)*sp(4,j)/kmmno2))*(sw08+
     +(0.1D1-sw08)*sp(5,j)/kmfeoh3))*(sw10+(0.1D1-sw10)*sp(6,j)/kmso4)-(
     +-6*sp(6,j)+3*sp(7,j)-3*sp(12,j)-3*sp(13,j)+3*sp(14,j)-3*sp(27,j)+6
     +*(-1+por(j))/por(j)*sp(25,j)+9*(-1+por(j))/por(j)*sp(28,j))/delt+(
     +-6*spold(6,j)+3*spold(7,j)-3*spold(12,j)-3*spold(13,j)-3*spold(27,
     +j)+3*spold(14,j)+6*(-1+por(j))/por(j)*spold(25,j)+9*(-1+por(j))/po
     +r(j)*spold(28,j))/delt
          funcs(14) = -(0.1D1-sw17)*kdis*sw18*sp(14,j)*(ch4eq-sp(7,j))+s
     +w17*kgas*(sp(7,j)-ch4eq)-sp(14,j)/delt+spold(14,j)/delt
          funcs(15) = sp(20,j)*sp(16,j)-keq1*sp(15,j)
          funcs(16) = sp(20,j)*sp(17,j)-keq2*sp(16,j)
          funcs(17) = -(-1+por(j))/por(j)*nu/(inita+sp(32,j))*sp(1,j)*(s
     +w02+(0.1D1-sw02)*sp(2,j)/kmo2)-(682375.D0/58668.D0*sp(38,j)-4611.D
     +0/4889.D0*sp(40,j)-203785.D0/58668.D0*sp(46,j)+0.3616667D7/704016.
     +D0*sp(50,j)+277561.D0/19556.D0*sp(42,j)+286783.D0/29334.D0*sp(43,j
     +)+314449.D0/58668.D0*sp(44,j)+4611.D0/4889.D0*sp(45,j)-9.D0/2.D0*s
     +p(16,j)-107.D0/12.D0*sp(17,j)-53.D0/12.D0*sp(18,j)+53.D0/12.D0*sp(
     +20,j)+53.D0/6.D0*sp(11,j)+53.D0/6.D0*sp(12,j)+53.D0/12.D0*sp(13,j)
     +-sp(14,j)/12-sp(15,j)/12+53.D0/6.D0*sp(27,j)+409955.D0/29334.D0*sp
     +(22,j)-sp(7,j)/12+53.D0/12.D0*sp(8,j)+53.D0/6.D0*sp(10,j)-53.D0/12
     +.D0*sp(3,j)-98929.D0/19556.D0*(-1+por(j))/por(j)*sp(21,j)-53.D0/12
     +.D0*(-1+por(j))/por(j)*sp(23,j)-53.D0/6.D0*(-1+por(j))/por(j)*sp(2
     +5,j)+(-1+por(j))/por(j)*sp(26,j)/12-53.D0/3.D0*(-1+por(j))/por(j)*
     +sp(28,j)-53.D0/6.D0*(-1+por(j))/por(j)*sp(29,j)+(-1+por(j))/por(j)
     +*sp(31,j)/12-98929.D0/19556.D0*(-1+por(j))/por(j)*sp(36,j)-98929.D
     +0/19556.D0*(-1+por(j))/por(j)*sp(37,j)+0.7100039D7/0.78224D7*(-1+p
     +or(j))/por(j)*sp(39,j)+4611.D0/4889.D0*(-1+por(j))/por(j)*sp(41,j)
     ++73776.D0/122225.D0*(-1+por(j))/por(j)*sp(47,j)-1022847.D0/39112.D
     +0*(-1+por(j))/por(j)*sp(48,j))/delt+(-spold(7,j)/12+53.D0/12.D0*sp
     +old(8,j)+53.D0/6.D0*spold(10,j)-53.D0/12.D0*spold(3,j)+682375.D0/5
     +8668.D0*spold(38,j)-4611.D0/4889.D0*spold(40,j)-203785.D0/58668.D0
     +*spold(46,j)+0.3616667D7/704016.D0*spold(50,j)+277561.D0/19556.D0*
     +spold(42,j)+286783.D0/29334.D0*spold(43,j)+314449.D0/58668.D0*spol
     +d(44,j)+4611.D0/4889.D0*spold(45,j)-9.D0/2.D0*spold(16,j)-107.D0/1
     +2.D0*spold(17,j)-53.D0/12.D0*spold(18,j)+53.D0/12.D0*spold(20,j)+5
     +3.D0/6.D0*spold(11,j)+53.D0/6.D0*spold(12,j)+53.D0/12.D0*spold(13,
     +j)-spold(14,j)/12-spold(15,j)/12+53.D0/6.D0*spold(27,j)+409955.D0/
     +29334.D0*spold(22,j)-98929.D0/19556.D0*(-1+por(j))/por(j)*spold(21
     +,j)-53.D0/12.D0*(-1+por(j))/por(j)*spold(23,j)-53.D0/6.D0*(-1+por(
     +j))/por(j)*spold(25,j)+(-1+por(j))/por(j)*spold(26,j)/12-53.D0/3.D
     +0*(-1+por(j))/por(j)*spold(28,j)-53.D0/6.D0*(-1+por(j))/por(j)*spo
     +ld(29,j)+(-1+por(j))/por(j)*spold(31,j)/12-98929.D0/19556.D0*(-1+p
     +or(j))/por(j)*spold(36,j)-98929.D0/19556.D0*(-1+por(j))/por(j)*spo
     +ld(37,j)+0.7100039D7/0.78224D7*(-1+por(j))/por(j)*spold(39,j)+4611
     +.D0/4889.D0*(-1+por(j))/por(j)*spold(41,j)+73776.D0/122225.D0*(-1+
     +por(j))/por(j)*spold(47,j)-1022847.D0/39112.D0*(-1+por(j))/por(j)*
     +spold(48,j))/delt
          funcs(18) = sp(20,j)*sp(18,j)-keq4*sp(19,j)
          funcs(19) = sp(18,j)-spold(18,j)+sp(19,j)-spold(19,j)
          funcs(20) = sp(43,j)*sp(20,j)-eq1_al*sp(42,j)
          funcs(21) = -sw15*kcaldiss*sp(21,j)*(0.1D1-sp(22,j)*sp(17,j)/k
     +spcal)-por(j)/(-1+por(j))*sw20*kcalppt*(sp(22,j)*sp(17,j)/kspcal-0
     +.5D1)-sp(21,j)/delt+spold(21,j)/delt
          funcs(22) = -sw22*karappt*(sp(22,j)*sp(17,j)/kspara-0.5D1)-(-1
     ++por(j))/por(j)*sw21*karadis*sp(36,j)*(0.1D1-sp(22,j)*sp(17,j)/ksp
     +ara)-(-1+por(j))/por(j)*sp(36,j)/delt+(-1+por(j))/por(j)*spold(36,
     +j)/delt
          funcs(23) = -6.D0/53.D0*por(j)/(-1+por(j))*kfeco3precip*sw14*(
     +sp(11,j)*sp(17,j)/KsFeCO3-0.1D1)-6.D0/53.D0*sp(26,j)/delt+6.D0/53.
     +D0*spold(26,j)/delt
          funcs(24) = ksfp*(sp(5,j)+sp(34,j)+sp(35,j))*sp(9,j)-sp(30,j)
          funcs(25) = -kfesdiss*(0.1D1-sw13)*sp(25,j)*(0.1D1-sp(11,j)*sp
     +(13,j)/sp(20,j)/KsFeS)-kfeso2*sp(25,j)*sp(2,j)-por(j)/(-1+por(j))*
     +kfesprecip*sw13*(sp(11,j)*sp(13,j)/sp(20,j)/KsFeS-0.1D1)-(sp(25,j)
     ++sp(28,j))/delt+(spold(25,j)+spold(28,j))/delt
          funcs(26) = -kfemno2pr*sp(11,j)*sp(33,j)-kh2smno2pr*sp(33,j)*(
     +sp(12,j)+sp(13,j))+kmnage*sp(4,j)-(-sp(4,j)-sp(31,j)+por(j)/(-1+po
     +r(j))*sp(10,j))/delt+(-spold(4,j)-spold(31,j)+por(j)/(-1+por(j))*s
     +pold(10,j))/delt
          funcs(27) = 8.D0/3.D0*(-1+por(j))/por(j)*kpyr*sp(25,j)*(sp(12,
     +j)+sp(13,j))-(-206000.D0/14667.D0*sp(38,j)+5568.D0/4889.D0*sp(40,j
     +)+61520.D0/14667.D0*sp(46,j)-272956.D0/44001.D0*sp(50,j)-83792.D0/
     +4889.D0*sp(42,j)-173152.D0/14667.D0*sp(43,j)-94928.D0/14667.D0*sp(
     +44,j)-5568.D0/4889.D0*sp(45,j)-56.D0/159.D0*sp(16,j)+264.D0/53.D0*
     +sp(17,j)+16.D0/3.D0*sp(18,j)-16.D0/3.D0*sp(20,j)-28.D0/3.D0*sp(11,
     +j)+16.D0/3.D0*sp(13,j)+264.D0/53.D0*sp(14,j)-904.D0/159.D0*sp(15,j
     +)-8.D0/3.D0*sp(27,j)-247520.D0/14667.D0*sp(22,j)+264.D0/53.D0*sp(7
     +,j)-4.D0/3.D0*sp(8,j)-8*sp(10,j)-16.D0/3.D0*sp(2,j)-4.D0/3.D0*sp(3
     +,j)+0.9246472D7/777351.D0*(-1+por(j))/por(j)*sp(21,j)+4.D0/3.D0*(-
     +1+por(j))/por(j)*sp(23,j)-4.D0/3.D0*(-1+por(j))/por(j)*sp(25,j)+69
     +2.D0/159.D0*(-1+por(j))/por(j)*sp(26,j)+4.D0/3.D0*(-1+por(j))/por(
     +j)*sp(28,j)+28.D0/3.D0*(-1+por(j))/por(j)*sp(29,j)+160.D0/53.D0*(-
     +1+por(j))/por(j)*sp(31,j)+0.9246472D7/777351.D0*(-1+por(j))/por(j)
     +*sp(36,j)+0.9246472D7/777351.D0*(-1+por(j))/por(j)*sp(37,j)-133963
     +.D0/122225.D0*(-1+por(j))/por(j)*sp(39,j)-5568.D0/4889.D0*(-1+por(
     +j))/por(j)*sp(41,j)-89088.D0/122225.D0*(-1+por(j))/por(j)*sp(47,j)
     ++154392.D0/4889.D0*(-1+por(j))/por(j)*sp(48,j))/delt+(264.D0/53.D0
     +*spold(7,j)-4.D0/3.D0*spold(8,j)-8*spold(10,j)-16.D0/3.D0*spold(2,
     +j)-4.D0/3.D0*spold(3,j)-206000.D0/14667.D0*spold(38,j)+5568.D0/488
     +9.D0*spold(40,j)+61520.D0/14667.D0*spold(46,j)-272956.D0/44001.D0*
     +spold(50,j)-83792.D0/4889.D0*spold(42,j)-173152.D0/14667.D0*spold(
     +43,j)-94928.D0/14667.D0*spold(44,j)-5568.D0/4889.D0*spold(45,j)-56
     +.D0/159.D0*spold(16,j)+264.D0/53.D0*spold(17,j)+16.D0/3.D0*spold(1
     +8,j)-16.D0/3.D0*spold(20,j)-28.D0/3.D0*spold(11,j)+16.D0/3.D0*spol
     +d(13,j)+264.D0/53.D0*spold(14,j)-904.D0/159.D0*spold(15,j)-8.D0/3.
     +D0*spold(27,j)-247520.D0/14667.D0*spold(22,j)+0.9246472D7/777351.D
     +0*(-1+por(j))/por(j)*spold(21,j)+4.D0/3.D0*(-1+por(j))/por(j)*spol
     +d(23,j)-4.D0/3.D0*(-1+por(j))/por(j)*spold(25,j)+692.D0/159.D0*(-1
     ++por(j))/por(j)*spold(26,j)+4.D0/3.D0*(-1+por(j))/por(j)*spold(28,
     +j)+28.D0/3.D0*(-1+por(j))/por(j)*spold(29,j)+160.D0/53.D0*(-1+por(
     +j))/por(j)*spold(31,j)+0.9246472D7/777351.D0*(-1+por(j))/por(j)*sp
     +old(36,j)+0.9246472D7/777351.D0*(-1+por(j))/por(j)*spold(37,j)-133
     +963.D0/122225.D0*(-1+por(j))/por(j)*spold(39,j)-5568.D0/4889.D0*(-
     +1+por(j))/por(j)*spold(41,j)-89088.D0/122225.D0*(-1+por(j))/por(j)
     +*spold(47,j)+154392.D0/4889.D0*(-1+por(j))/por(j)*spold(48,j))/del
     +t
          funcs(28) = kfess0*sp(25,j)*sp(27,j)/8-(-1155809.D0/0.2072936D
     +7*sp(36,j)-1155809.D0/0.2072936D7*sp(37,j)+401889.D0/0.78224D7*sp(
     +39,j)-15.D0/106.D0*sp(31,j)+4176.D0/122225.D0*sp(47,j)-57897.D0/39
     +112.D0*sp(48,j)+261.D0/4889.D0*sp(41,j)-173.D0/848.D0*sp(26,j)+sp(
     +28,j)/16-7.D0/16.D0*sp(29,j)-1155809.D0/0.2072936D7*sp(21,j)-sp(23
     +,j)/16+sp(25,j)/16+por(j)/(-1+por(j))*sp(2,j)/4+por(j)/(-1+por(j))
     +*sp(3,j)/16-99.D0/424.D0*por(j)/(-1+por(j))*sp(7,j)+por(j)/(-1+por
     +(j))*sp(8,j)/16+3.D0/8.D0*por(j)/(-1+por(j))*sp(10,j)+7.D0/16.D0*p
     +or(j)/(-1+por(j))*sp(11,j)-por(j)/(-1+por(j))*sp(13,j)/4-99.D0/424
     +.D0*por(j)/(-1+por(j))*sp(14,j)+113.D0/424.D0*por(j)/(-1+por(j))*s
     +p(15,j)+7.D0/424.D0*por(j)/(-1+por(j))*sp(16,j)-99.D0/424.D0*por(j
     +)/(-1+por(j))*sp(17,j)-por(j)/(-1+por(j))*sp(18,j)/4+por(j)/(-1+po
     +r(j))*sp(20,j)/4+7735.D0/9778.D0*por(j)/(-1+por(j))*sp(22,j)+por(j
     +)/(-1+por(j))*sp(27,j)/8+12875.D0/19556.D0*por(j)/(-1+por(j))*sp(3
     +8,j)-261.D0/4889.D0*por(j)/(-1+por(j))*sp(40,j)+15711.D0/19556.D0*
     +por(j)/(-1+por(j))*sp(42,j)+5411.D0/9778.D0*por(j)/(-1+por(j))*sp(
     +43,j)+5933.D0/19556.D0*por(j)/(-1+por(j))*sp(44,j)+261.D0/4889.D0*
     +por(j)/(-1+por(j))*sp(45,j)-3845.D0/19556.D0*por(j)/(-1+por(j))*sp
     +(46,j)+68239.D0/234672.D0*por(j)/(-1+por(j))*sp(50,j))/delt+(-1155
     +809.D0/0.2072936D7*spold(36,j)-1155809.D0/0.2072936D7*spold(37,j)+
     +401889.D0/0.78224D7*spold(39,j)-15.D0/106.D0*spold(31,j)+4176.D0/1
     +22225.D0*spold(47,j)-57897.D0/39112.D0*spold(48,j)+261.D0/4889.D0*
     +spold(41,j)-173.D0/848.D0*spold(26,j)+spold(28,j)/16-7.D0/16.D0*sp
     +old(29,j)-1155809.D0/0.2072936D7*spold(21,j)-spold(23,j)/16+spold(
     +25,j)/16-99.D0/424.D0*por(j)/(-1+por(j))*spold(17,j)-por(j)/(-1+po
     +r(j))*spold(18,j)/4+por(j)/(-1+por(j))*spold(20,j)/4+7735.D0/9778.
     +D0*por(j)/(-1+por(j))*spold(22,j)+por(j)/(-1+por(j))*spold(27,j)/8
     ++12875.D0/19556.D0*por(j)/(-1+por(j))*spold(38,j)-261.D0/4889.D0*p
     +or(j)/(-1+por(j))*spold(40,j)+15711.D0/19556.D0*por(j)/(-1+por(j))
     +*spold(42,j)+5411.D0/9778.D0*por(j)/(-1+por(j))*spold(43,j)+5933.D
     +0/19556.D0*por(j)/(-1+por(j))*spold(44,j)+261.D0/4889.D0*por(j)/(-
     +1+por(j))*spold(45,j)-3845.D0/19556.D0*por(j)/(-1+por(j))*spold(46
     +,j)+68239.D0/234672.D0*por(j)/(-1+por(j))*spold(50,j)+por(j)/(-1+p
     +or(j))*spold(2,j)/4+por(j)/(-1+por(j))*spold(3,j)/16-99.D0/424.D0*
     +por(j)/(-1+por(j))*spold(7,j)+por(j)/(-1+por(j))*spold(8,j)/16+3.D
     +0/8.D0*por(j)/(-1+por(j))*spold(10,j)+7.D0/16.D0*por(j)/(-1+por(j)
     +)*spold(11,j)-por(j)/(-1+por(j))*spold(13,j)/4-99.D0/424.D0*por(j)
     +/(-1+por(j))*spold(14,j)+113.D0/424.D0*por(j)/(-1+por(j))*spold(15
     +,j)+7.D0/424.D0*por(j)/(-1+por(j))*spold(16,j))/delt
          funcs(29) = 2*kh2sfeoh3mr*sp(34,j)*(sp(12,j)+sp(13,j))-kfeage*
     +sp(5,j)+sp(34,j)/delt-spold(34,j)/delt
          funcs(30) = por(j)/(-1+por(j))*sw16*kapa*(sp(9,j)-po4_eq)-(-sp
     +(21,j)/106+sp(24,j)-sp(26,j)/106+sp(30,j)-sp(31,j)/106-sp(36,j)/10
     +6-sp(37,j)/106+por(j)/(-1+por(j))*sp(7,j)/106+por(j)/(-1+por(j))*s
     +p(14,j)/106+por(j)/(-1+por(j))*sp(15,j)/106+por(j)/(-1+por(j))*sp(
     +16,j)/106+por(j)/(-1+por(j))*sp(17,j)/106-por(j)/(-1+por(j))*sp(9,
     +j))/delt+(spold(30,j)-spold(21,j)/106+spold(24,j)-spold(26,j)/106-
     +spold(31,j)/106-spold(36,j)/106-spold(37,j)/106-por(j)/(-1+por(j))
     +*spold(9,j)+por(j)/(-1+por(j))*spold(17,j)/106+por(j)/(-1+por(j))*
     +spold(7,j)/106+por(j)/(-1+por(j))*spold(14,j)/106+por(j)/(-1+por(j
     +))*spold(15,j)/106+por(j)/(-1+por(j))*spold(16,j)/106)/delt
          funcs(31) = -3.D0/10.D0*sw27*kplagio*sp(48,j)*(sp(20,j)**3/sp(
     +42,j))**0.35D0*(0.1D1-sp(40,j)**0.23D1*sp(42,j)**0.17D1*sp(49,j)**
     +0.7D0*sp(22,j)**0.3D0/kspplagio)-3.D0/10.D0*sp(48,j)/delt+3.D0/10.
     +D0*spold(48,j)/delt
          funcs(32) = sp(32,j)-spold(32,j)
          funcs(33) = sp(4,j)-spold(4,j)-por(j)/(-1+por(j))*(sp(10,j)-sp
     +old(10,j))+sp(31,j)-spold(31,j)+sp(33,j)-spold(33,j)
          funcs(34) = 2*kh2sfeoh3pr*sp(35,j)*(sp(12,j)+sp(13,j))-(sp(5,j
     +)+sp(25,j)+sp(26,j)+sp(28,j)+sp(29,j)+sp(34,j)-por(j)/(-1+por(j))*
     +sp(11,j))/delt+(spold(25,j)+spold(29,j)+spold(5,j)+spold(26,j)+spo
     +ld(28,j)+spold(34,j)-por(j)/(-1+por(j))*spold(11,j))/delt
          funcs(35) = sp(5,j)-spold(5,j)-por(j)/(-1+por(j))*(sp(11,j)-sp
     +old(11,j))+sp(25,j)-spold(25,j)+sp(26,j)-spold(26,j)+sp(28,j)-spol
     +d(28,j)+sp(29,j)-spold(29,j)+sp(34,j)-spold(34,j)+sp(35,j)-spold(3
     +5,j)
          funcs(36) = rate46+por(j)/(-1+por(j))*rate47+sp(37,j)/delt-spo
     +ld(37,j)/delt
          funcs(37) = -689.D0/69.D0*por(j)/(-1+por(j))*knit*sp(8,j)*sp(2
     +,j)-(sp(21,j)-53.D0/6.D0*sp(23,j)+sp(26,j)+sp(31,j)+sp(36,j)+sp(37
     +,j)-53.D0/46.D0*por(j)/(-1+por(j))*sp(3,j)-por(j)/(-1+por(j))*sp(7
     +,j)+53.D0/6.D0*por(j)/(-1+por(j))*sp(8,j)-por(j)/(-1+por(j))*sp(14
     +,j)-por(j)/(-1+por(j))*sp(15,j)-por(j)/(-1+por(j))*sp(16,j)-por(j)
     +/(-1+por(j))*sp(17,j))/delt+(spold(21,j)-53.D0/6.D0*spold(23,j)+sp
     +old(26,j)+spold(31,j)+spold(36,j)+spold(37,j)-por(j)/(-1+por(j))*s
     +pold(17,j)-53.D0/46.D0*por(j)/(-1+por(j))*spold(3,j)-por(j)/(-1+po
     +r(j))*spold(7,j)+53.D0/6.D0*por(j)/(-1+por(j))*spold(8,j)-por(j)/(
     +-1+por(j))*spold(14,j)-por(j)/(-1+por(j))*spold(15,j)-por(j)/(-1+p
     +or(j))*spold(16,j))/delt
          funcs(38) = -8.D0/5.D0*(-1+por(j))/por(j)*sw28*kolive*sp(51,j)
     +*(0.1D1-sp(40,j)*sp(38,j)**0.16D1*sp(11,j)**0.4D0/sp(20,j)**4/kspo
     +live)-(-5088.D0/4889.D0*sp(22,j)+5120.D0/4889.D0*sp(38,j)+1848.D0/
     +24445.D0*sp(42,j)-1848.D0/24445.D0*sp(40,j)-20912.D0/73335.D0*sp(5
     +0,j)+1848.D0/24445.D0*sp(43,j)+1848.D0/24445.D0*sp(44,j)+1848.D0/2
     +4445.D0*sp(45,j)+1848.D0/24445.D0*sp(46,j)+5088.D0/4889.D0*(-1+por
     +(j))/por(j)*sp(21,j)+5088.D0/4889.D0*(-1+por(j))/por(j)*sp(36,j)+5
     +088.D0/4889.D0*(-1+por(j))/por(j)*sp(37,j)+92169.D0/0.122225D7*(-1
     ++por(j))/por(j)*sp(39,j)+1848.D0/24445.D0*(-1+por(j))/por(j)*sp(41
     +,j)+29568.D0/611125.D0*(-1+por(j))/por(j)*sp(47,j)+43704.D0/122225
     +.D0*(-1+por(j))/por(j)*sp(48,j))/delt+(-5088.D0/4889.D0*spold(22,j
     +)+5120.D0/4889.D0*spold(38,j)-1848.D0/24445.D0*spold(40,j)+1848.D0
     +/24445.D0*spold(42,j)+1848.D0/24445.D0*spold(43,j)+1848.D0/24445.D
     +0*spold(44,j)+1848.D0/24445.D0*spold(45,j)+1848.D0/24445.D0*spold(
     +46,j)-20912.D0/73335.D0*spold(50,j)+5088.D0/4889.D0*(-1+por(j))/po
     +r(j)*spold(21,j)+5088.D0/4889.D0*(-1+por(j))/por(j)*spold(36,j)+50
     +88.D0/4889.D0*(-1+por(j))/por(j)*spold(37,j)+92169.D0/0.122225D7*(
     +-1+por(j))/por(j)*spold(39,j)+1848.D0/24445.D0*(-1+por(j))/por(j)*
     +spold(41,j)+29568.D0/611125.D0*(-1+por(j))/por(j)*spold(47,j)+4370
     +4.D0/122225.D0*(-1+por(j))/por(j)*spold(48,j))/delt
          funcs(39) = -sw25*(kBSidis*bd+(kBSidis-kBSidis*bd)*exp(-ad*x_p
     +os))*sp(39,j)*(0.1D1-sp(40,j)/BSisat)-sp(39,j)/delt+spold(39,j)/de
     +lt
          funcs(40) = ksfsi*(sp(5,j)+sp(34,j)+sp(35,j))*sp(40,j)-sp(41,j
     +)
          funcs(41) = sw26*kglass*sp(47,j)*(sp(20,j)**3/sp(42,j))**(1.D0
     +/3.D0)*(0.1D1-sp(40,j)*sp(42,j)**0.36D0/sp(20,j)**0.108D1/kspglass
     +)+sp(47,j)/delt-spold(47,j)/delt
          funcs(42) = sp(44,j)*sp(20,j)-eq2_al*sp(43,j)
          funcs(43) = sp(45,j)*sp(20,j)-eq3_al*sp(44,j)
          funcs(44) = sp(46,j)*sp(20,j)-eq4_al*sp(45,j)
          funcs(45) = 12.D0/53.D0*(-1+por(j))/por(j)*nu/(inita+sp(32,j))
     +*sp(1,j)*sw11*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw
     +02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3)-sw
     +05*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-(0.1D1-s
     +w02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3))*(sw06+(0.1D1
     +-sw06)*sp(4,j)/kmmno2)-sw07*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-
     +sw03*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(
     +3,j)/kmno3)-sw05*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1
     +-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3)
     +)*(sw06+(0.1D1-sw06)*sp(4,j)/kmmno2))*(sw08+(0.1D1-sw08)*sp(5,j)/k
     +mfeoh3)-sw09*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw0
     +2-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3)-sw0
     +5*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-(0.1D1-sw
     +02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3))*(sw06+(0.1D1-
     +sw06)*sp(4,j)/kmmno2)-sw07*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-s
     +w03*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3
     +,j)/kmno3)-sw05*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-
     +sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3))
     +*(sw06+(0.1D1-sw06)*sp(4,j)/kmmno2))*(sw08+(0.1D1-sw08)*sp(5,j)/km
     +feoh3))*(sw10+(0.1D1-sw10)*sp(6,j)/kmso4))+12.D0/53.D0*(-1+por(j))
     +/por(j)*nu/(inita+sp(32,j))*sp(1,j)*sw09*(0.1D1-sw02-(0.1D1-sw02)*
     +sp(2,j)/kmo2-sw03*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.
     +1D1-sw04)*sp(3,j)/kmno3)-sw05*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo
     +2-sw03*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*s
     +p(3,j)/kmno3))*(sw06+(0.1D1-sw06)*sp(4,j)/kmmno2)-sw07*(0.1D1-sw02
     +-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/k
     +mo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3)-sw05*(0.1D1-sw02-(0.1D1-sw0
     +2)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+
     +(0.1D1-sw04)*sp(3,j)/kmno3))*(sw06+(0.1D1-sw06)*sp(4,j)/kmmno2))*(
     +sw08+(0.1D1-sw08)*sp(5,j)/kmfeoh3))*(sw10+(0.1D1-sw10)*sp(6,j)/kms
     +o4)+12.D0/53.D0*(-1+por(j))/por(j)*nu/(inita+sp(32,j))*sp(1,j)*sw0
     +5*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-(0.1D1-sw
     +02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3))*(sw06+(0.1D1-
     +sw06)*sp(4,j)/kmmno2)+12.D0/53.D0*(-1+por(j))/por(j)*nu/(inita+sp(
     +32,j))*sp(1,j)*sw07*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.
     +1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmn
     +o3)-sw05*(0.1D1-sw02-(0.1D1-sw02)*sp(2,j)/kmo2-sw03*(0.1D1-sw02-(0
     +.1D1-sw02)*sp(2,j)/kmo2)*(sw04+(0.1D1-sw04)*sp(3,j)/kmno3))*(sw06+
     +(0.1D1-sw06)*sp(4,j)/kmmno2))*(sw08+(0.1D1-sw08)*sp(5,j)/kmfeoh3)-
     +(12875.D0/4889.D0*sp(38,j)-1044.D0/4889.D0*sp(40,j)-3845.D0/4889.D
     +0*sp(46,j)+68239.D0/58668.D0*sp(50,j)+15711.D0/4889.D0*sp(42,j)+10
     +822.D0/4889.D0*sp(43,j)+5933.D0/4889.D0*sp(44,j)+1044.D0/4889.D0*s
     +p(45,j)-840.D0/689.D0*sp(16,j)-1529.D0/689.D0*sp(17,j)-sp(18,j)+sp
     +(20,j)+2*sp(11,j)+2*sp(12,j)+sp(13,j)-151.D0/689.D0*sp(14,j)-151.D
     +0/689.D0*sp(15,j)+2*sp(27,j)+15470.D0/4889.D0*sp(22,j)-151.D0/689.
     +D0*sp(7,j)+10.D0/13.D0*sp(8,j)+2*sp(10,j)-16.D0/13.D0*sp(3,j)-3183
     +549.D0/0.3368521D7*(-1+por(j))/por(j)*sp(21,j)-10.D0/13.D0*(-1+por
     +(j))/por(j)*sp(23,j)-2*(-1+por(j))/por(j)*sp(25,j)+151.D0/689.D0*(
     +-1+por(j))/por(j)*sp(26,j)-4*(-1+por(j))/por(j)*sp(28,j)-2*(-1+por
     +(j))/por(j)*sp(29,j)+151.D0/689.D0*(-1+por(j))/por(j)*sp(31,j)-318
     +3549.D0/0.3368521D7*(-1+por(j))/por(j)*sp(36,j)-3183549.D0/0.33685
     +21D7*(-1+por(j))/por(j)*sp(37,j)+401889.D0/0.19556D7*(-1+por(j))/p
     +or(j)*sp(39,j)+1044.D0/4889.D0*(-1+por(j))/por(j)*sp(41,j)+16704.D
     +0/122225.D0*(-1+por(j))/por(j)*sp(47,j)-57897.D0/9778.D0*(-1+por(j
     +))/por(j)*sp(48,j))/delt+(-151.D0/689.D0*spold(7,j)+10.D0/13.D0*sp
     +old(8,j)+2*spold(10,j)-16.D0/13.D0*spold(3,j)+12875.D0/4889.D0*spo
     +ld(38,j)-1044.D0/4889.D0*spold(40,j)-3845.D0/4889.D0*spold(46,j)+6
     +8239.D0/58668.D0*spold(50,j)+15711.D0/4889.D0*spold(42,j)+10822.D0
     +/4889.D0*spold(43,j)+5933.D0/4889.D0*spold(44,j)+1044.D0/4889.D0*s
     +pold(45,j)-840.D0/689.D0*spold(16,j)-1529.D0/689.D0*spold(17,j)-sp
     +old(18,j)+spold(20,j)+2*spold(11,j)+2*spold(12,j)+spold(13,j)-151.
     +D0/689.D0*spold(14,j)-151.D0/689.D0*spold(15,j)+2*spold(27,j)+1547
     +0.D0/4889.D0*spold(22,j)-3183549.D0/0.3368521D7*(-1+por(j))/por(j)
     +*spold(21,j)-10.D0/13.D0*(-1+por(j))/por(j)*spold(23,j)-2*(-1+por(
     +j))/por(j)*spold(25,j)+151.D0/689.D0*(-1+por(j))/por(j)*spold(26,j
     +)-4*(-1+por(j))/por(j)*spold(28,j)-2*(-1+por(j))/por(j)*spold(29,j
     +)+151.D0/689.D0*(-1+por(j))/por(j)*spold(31,j)-3183549.D0/0.336852
     +1D7*(-1+por(j))/por(j)*spold(36,j)-3183549.D0/0.3368521D7*(-1+por(
     +j))/por(j)*spold(37,j)+401889.D0/0.19556D7*(-1+por(j))/por(j)*spol
     +d(39,j)+1044.D0/4889.D0*(-1+por(j))/por(j)*spold(41,j)+16704.D0/12
     +2225.D0*(-1+por(j))/por(j)*spold(47,j)-57897.D0/9778.D0*(-1+por(j)
     +)/por(j)*spold(48,j))/delt
          funcs(46) = 7697.D0/3000.D0*(-1+por(j))/por(j)*sw29*kpyrox*sp(
     +52,j)*(0.1D1-sp(40,j)**2*sp(11,j)**0.46D0*sp(38,j)**0.84D0*sp(22,j
     +)**0.7D0/sp(20,j)**4/ksppyrox)-(-515699.D0/117336.D0*sp(22,j)-8466
     +7.D0/391120.D0*sp(38,j)-84667.D0/244450.D0*sp(42,j)+84667.D0/24445
     +0.D0*sp(40,j)-14139389.D0/0.234672D8*sp(50,j)-84667.D0/244450.D0*s
     +p(43,j)-84667.D0/244450.D0*sp(44,j)-84667.D0/244450.D0*sp(45,j)-84
     +667.D0/244450.D0*sp(46,j)+515699.D0/117336.D0*(-1+por(j))/por(j)*s
     +p(21,j)+515699.D0/117336.D0*(-1+por(j))/por(j)*sp(36,j)+515699.D0/
     +117336.D0*(-1+por(j))/por(j)*sp(37,j)-33782133.D0/0.9778D8*(-1+por
     +(j))/por(j)*sp(39,j)-84667.D0/244450.D0*(-1+por(j))/por(j)*sp(41,j
     +)-677336.D0/0.3055625D7*(-1+por(j))/por(j)*sp(47,j)+0.10860467D8/0
     +.9778D7*(-1+por(j))/por(j)*sp(48,j))/delt+(-515699.D0/117336.D0*sp
     +old(22,j)-84667.D0/391120.D0*spold(38,j)+84667.D0/244450.D0*spold(
     +40,j)-84667.D0/244450.D0*spold(42,j)-84667.D0/244450.D0*spold(43,j
     +)-84667.D0/244450.D0*spold(44,j)-84667.D0/244450.D0*spold(45,j)-84
     +667.D0/244450.D0*spold(46,j)-14139389.D0/0.234672D8*spold(50,j)+51
     +5699.D0/117336.D0*(-1+por(j))/por(j)*spold(21,j)+515699.D0/117336.
     +D0*(-1+por(j))/por(j)*spold(36,j)+515699.D0/117336.D0*(-1+por(j))/
     +por(j)*spold(37,j)-33782133.D0/0.9778D8*(-1+por(j))/por(j)*spold(3
     +9,j)-84667.D0/244450.D0*(-1+por(j))/por(j)*spold(41,j)-677336.D0/0
     +.3055625D7*(-1+por(j))/por(j)*spold(47,j)+0.10860467D8/0.9778D7*(-
     +1+por(j))/por(j)*spold(48,j))/delt
          funcs(47) = 103505.D0/61576.D0*por(j)/(-1+por(j))*sw30*killite
     +*(sp(40,j)**0.35D1*sp(42,j)**0.23D1*sp(50,j)**0.6D0*sp(38,j)**0.25
     +D0/sp(20,j)**8/kspillite-0.1D1)+517525.D0/184728.D0*por(j)/(-1+por
     +(j))*sp(50,j)/delt-517525.D0/184728.D0*por(j)/(-1+por(j))*spold(50
     +,j)/delt
          funcs(48) = -125529.D0/103505.D0*por(j)/(-1+por(j))*sw31*ksmec
     +t*(sp(22,j)**0.165D0*sp(38,j)**0.33D0*sp(42,j)**0.17D1*sp(40,j)**4
     +/sp(20,j)**6/kspsmect-0.1D1)-(-224947968.D0/0.506035945D9*sp(47,j)
     ++0.2259522D7/0.101207189D9*sp(48,j)+0.14812422D9/0.101207189D9*sp(
     +21,j)+0.14812422D9/0.101207189D9*sp(36,j)+0.14812422D9/0.101207189
     +D9*sp(37,j)-350602497.D0/0.506035945D9*sp(39,j)-70296240.D0/0.1012
     +07189D9*sp(41,j)-148124220.D0/0.101207189D9*por(j)/(-1+por(j))*sp(
     +22,j)-43935150.D0/0.101207189D9*por(j)/(-1+por(j))*sp(38,j)+0.7029
     +624D8/0.101207189D9*por(j)/(-1+por(j))*sp(40,j)-70296240.D0/0.1012
     +07189D9*por(j)/(-1+por(j))*sp(42,j)-70296240.D0/0.101207189D9*por(
     +j)/(-1+por(j))*sp(43,j)-70296240.D0/0.101207189D9*por(j)/(-1+por(j
     +))*sp(44,j)-70296240.D0/0.101207189D9*por(j)/(-1+por(j))*sp(45,j)-
     +70296240.D0/0.101207189D9*por(j)/(-1+por(j))*sp(46,j)-244572335.D0
     +/0.202414378D9*por(j)/(-1+por(j))*sp(50,j))/delt+(-350602497.D0/0.
     +506035945D9*spold(39,j)+0.14812422D9/0.101207189D9*spold(21,j)+0.1
     +4812422D9/0.101207189D9*spold(36,j)+0.14812422D9/0.101207189D9*spo
     +ld(37,j)-70296240.D0/0.101207189D9*spold(41,j)-224947968.D0/0.5060
     +35945D9*spold(47,j)+0.2259522D7/0.101207189D9*spold(48,j)-14812422
     +0.D0/0.101207189D9*por(j)/(-1+por(j))*spold(22,j)-43935150.D0/0.10
     +1207189D9*por(j)/(-1+por(j))*spold(38,j)+0.7029624D8/0.101207189D9
     +*por(j)/(-1+por(j))*spold(40,j)-70296240.D0/0.101207189D9*por(j)/(
     +-1+por(j))*spold(42,j)-70296240.D0/0.101207189D9*por(j)/(-1+por(j)
     +)*spold(43,j)-70296240.D0/0.101207189D9*por(j)/(-1+por(j))*spold(4
     +4,j)-70296240.D0/0.101207189D9*por(j)/(-1+por(j))*spold(45,j)-7029
     +6240.D0/0.101207189D9*por(j)/(-1+por(j))*spold(46,j)-244572335.D0/
     +0.202414378D9*por(j)/(-1+por(j))*spold(50,j))/delt
          funcs(49) = -7.D0/10.D0*(-1+por(j))/por(j)*(sp(48,j)-spold(48,
     +j))+sp(49,j)-spold(49,j)
          funcs(50) = 39112.D0/41843.D0*sw32*kkaoli*(sp(42,j)**2*sp(40,j
     +)**2/sp(20,j)**6/kspkaoli-0.1D1)-(-40120.D0/41843.D0*sp(22,j)-1190
     +0.D0/41843.D0*sp(38,j)-38596.D0/41843.D0*sp(42,j)+19040.D0/41843.D
     +0*sp(40,j)+sp(50,j)-38596.D0/41843.D0*sp(43,j)-38596.D0/41843.D0*s
     +p(44,j)-38596.D0/41843.D0*sp(45,j)-38596.D0/41843.D0*sp(46,j)+4012
     +0.D0/41843.D0*(-1+por(j))/por(j)*sp(21,j)+40120.D0/41843.D0*(-1+po
     +r(j))/por(j)*sp(36,j)+40120.D0/41843.D0*(-1+por(j))/por(j)*sp(37,j
     +)-1894351.D0/0.41843D7*(-1+por(j))/por(j)*sp(39,j)-19040.D0/41843.
     +D0*(-1+por(j))/por(j)*sp(41,j)-128636.D0/0.1046075D7*(-1+por(j))/p
     +or(j)*sp(47,j)+169286.D0/209215.D0*(-1+por(j))/por(j)*sp(48,j))/de
     +lt+(-40120.D0/41843.D0*spold(22,j)-11900.D0/41843.D0*spold(38,j)+1
     +9040.D0/41843.D0*spold(40,j)-38596.D0/41843.D0*spold(42,j)-38596.D
     +0/41843.D0*spold(43,j)-38596.D0/41843.D0*spold(44,j)-38596.D0/4184
     +3.D0*spold(45,j)-38596.D0/41843.D0*spold(46,j)+spold(50,j)+40120.D
     +0/41843.D0*(-1+por(j))/por(j)*spold(21,j)+40120.D0/41843.D0*(-1+po
     +r(j))/por(j)*spold(36,j)+40120.D0/41843.D0*(-1+por(j))/por(j)*spol
     +d(37,j)-1894351.D0/0.41843D7*(-1+por(j))/por(j)*spold(39,j)-19040.
     +D0/41843.D0*(-1+por(j))/por(j)*spold(41,j)-128636.D0/0.1046075D7*(
     +-1+por(j))/por(j)*spold(47,j)+169286.D0/209215.D0*(-1+por(j))/por(
     +j)*spold(48,j))/delt
          funcs(51) = -spold(51,j)+sp(51,j)-3180.D0/4889.D0*sp(36,j)-318
     +0.D0/4889.D0*sp(37,j)-92169.D0/0.19556D7*sp(39,j)-3696.D0/122225.D
     +0*sp(47,j)-5463.D0/24445.D0*sp(48,j)-231.D0/4889.D0*sp(41,j)-3180.
     +D0/4889.D0*sp(21,j)+3180.D0/4889.D0*spold(36,j)+3180.D0/4889.D0*sp
     +old(37,j)+92169.D0/0.19556D7*spold(39,j)+3696.D0/122225.D0*spold(4
     +7,j)+5463.D0/24445.D0*spold(48,j)+231.D0/4889.D0*spold(41,j)+3180.
     +D0/4889.D0*spold(21,j)-231.D0/4889.D0*por(j)/(-1+por(j))*(sp(46,j)
     +-spold(46,j))+3180.D0/4889.D0*por(j)/(-1+por(j))*(sp(22,j)-spold(2
     +2,j))+2614.D0/14667.D0*por(j)/(-1+por(j))*(sp(50,j)-spold(50,j))-2
     +31.D0/4889.D0*por(j)/(-1+por(j))*(sp(43,j)-spold(43,j))-231.D0/488
     +9.D0*por(j)/(-1+por(j))*(sp(42,j)-spold(42,j))+231.D0/4889.D0*por(
     +j)/(-1+por(j))*(sp(40,j)-spold(40,j))-231.D0/4889.D0*por(j)/(-1+po
     +r(j))*(sp(45,j)-spold(45,j))-3200.D0/4889.D0*por(j)/(-1+por(j))*(s
     +p(38,j)-spold(38,j))-231.D0/4889.D0*por(j)/(-1+por(j))*(sp(44,j)-s
     +pold(44,j))
          funcs(52) = -spold(52,j)+sp(52,j)+8375.D0/4889.D0*sp(36,j)+837
     +5.D0/4889.D0*sp(37,j)-13167.D0/97780.D0*sp(39,j)-2112.D0/24445.D0*
     +sp(47,j)+4233.D0/9778.D0*sp(48,j)-660.D0/4889.D0*sp(41,j)+8375.D0/
     +4889.D0*sp(21,j)-8375.D0/4889.D0*spold(36,j)-8375.D0/4889.D0*spold
     +(37,j)+13167.D0/97780.D0*spold(39,j)+2112.D0/24445.D0*spold(47,j)-
     +4233.D0/9778.D0*spold(48,j)+660.D0/4889.D0*spold(41,j)-8375.D0/488
     +9.D0*spold(21,j)-660.D0/4889.D0*por(j)/(-1+por(j))*(sp(46,j)-spold
     +(46,j))-8375.D0/4889.D0*por(j)/(-1+por(j))*(sp(22,j)-spold(22,j))-
     +9185.D0/39112.D0*por(j)/(-1+por(j))*(sp(50,j)-spold(50,j))-660.D0/
     +4889.D0*por(j)/(-1+por(j))*(sp(43,j)-spold(43,j))-660.D0/4889.D0*p
     +or(j)/(-1+por(j))*(sp(42,j)-spold(42,j))+660.D0/4889.D0*por(j)/(-1
     ++por(j))*(sp(40,j)-spold(40,j))-660.D0/4889.D0*por(j)/(-1+por(j))*
     +(sp(45,j)-spold(45,j))-825.D0/9778.D0*por(j)/(-1+por(j))*(sp(38,j)
     +-spold(38,j))-660.D0/4889.D0*por(j)/(-1+por(j))*(sp(44,j)-spold(44
     +,j))
          funcs(53) = -5.D0/3.D0*por(j)/(-1+por(j))*(sp(50,j)-spold(50,j
     +))+sp(53,j)-spold(53,j)
          funcs(54) = -spold(54,j)+sp(54,j)-5900.D0/4889.D0*sp(36,j)-590
     +0.D0/4889.D0*sp(37,j)+2793.D0/4889.D0*sp(39,j)+1792.D0/4889.D0*sp(
     +47,j)-90.D0/4889.D0*sp(48,j)+2800.D0/4889.D0*sp(41,j)-5900.D0/4889
     +.D0*sp(21,j)+5900.D0/4889.D0*spold(36,j)+5900.D0/4889.D0*spold(37,
     +j)-2793.D0/4889.D0*spold(39,j)-1792.D0/4889.D0*spold(47,j)+90.D0/4
     +889.D0*spold(48,j)-2800.D0/4889.D0*spold(41,j)+5900.D0/4889.D0*spo
     +ld(21,j)+2800.D0/4889.D0*por(j)/(-1+por(j))*(sp(46,j)-spold(46,j))
     ++5900.D0/4889.D0*por(j)/(-1+por(j))*(sp(22,j)-spold(22,j))+29225.D
     +0/29334.D0*por(j)/(-1+por(j))*(sp(50,j)-spold(50,j))+2800.D0/4889.
     +D0*por(j)/(-1+por(j))*(sp(43,j)-spold(43,j))+2800.D0/4889.D0*por(j
     +)/(-1+por(j))*(sp(42,j)-spold(42,j))-2800.D0/4889.D0*por(j)/(-1+po
     +r(j))*(sp(40,j)-spold(40,j))+2800.D0/4889.D0*por(j)/(-1+por(j))*(s
     +p(45,j)-spold(45,j))+1750.D0/4889.D0*por(j)/(-1+por(j))*(sp(38,j)-
     +spold(38,j))+2800.D0/4889.D0*por(j)/(-1+por(j))*(sp(44,j)-spold(44
     +,j))
          funcs(55) = -spold(55,j)+sp(55,j)+5015.D0/4889.D0*sp(36,j)+501
     +5.D0/4889.D0*sp(37,j)-1894351.D0/0.39112D7*sp(39,j)-32159.D0/24445
     +0.D0*sp(47,j)+84643.D0/97780.D0*sp(48,j)-2380.D0/4889.D0*sp(41,j)+
     +5015.D0/4889.D0*sp(21,j)-5015.D0/4889.D0*spold(36,j)-5015.D0/4889.
     +D0*spold(37,j)+0.1894351D7/0.39112D7*spold(39,j)+32159.D0/244450.D
     +0*spold(47,j)-84643.D0/97780.D0*spold(48,j)+2380.D0/4889.D0*spold(
     +41,j)-5015.D0/4889.D0*spold(21,j)-9649.D0/9778.D0*por(j)/(-1+por(j
     +))*(sp(46,j)-spold(46,j))-5015.D0/4889.D0*por(j)/(-1+por(j))*(sp(2
     +2,j)-spold(22,j))+41843.D0/39112.D0*por(j)/(-1+por(j))*(sp(50,j)-s
     +pold(50,j))-9649.D0/9778.D0*por(j)/(-1+por(j))*(sp(43,j)-spold(43,
     +j))-9649.D0/9778.D0*por(j)/(-1+por(j))*(sp(42,j)-spold(42,j))+2380
     +.D0/4889.D0*por(j)/(-1+por(j))*(sp(40,j)-spold(40,j))-9649.D0/9778
     +.D0*por(j)/(-1+por(j))*(sp(45,j)-spold(45,j))-2975.D0/9778.D0*por(
     +j)/(-1+por(j))*(sp(38,j)-spold(38,j))-9649.D0/9778.D0*por(j)/(-1+p
     +or(j))*(sp(44,j)-spold(44,j))
      end
